<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Score de longévité – Widget</title>
  <style>
    :root{
      --bg: transparent;            /* fond transparent pour Notion */
      --card: rgba(255,255,255,0.9);
      --text: #0f172a;              /* slate-900 */
      --muted: #475569;             /* slate-600 */
      --ok: #10b981;                /* emerald */
      --warn: #f59e0b;              /* amber */
      --bad: #ef4444;               /* red */
      --accent: #6366f1;            /* indigo */
      --shadow: 0 10px 25px rgba(0,0,0,.08);
    }
    @media (prefers-color-scheme: dark) {
      :root{
        --card: rgba(15,23,42,0.85); /* slate-900 */
        --text: #e5e7eb;             /* zinc-200 */
        --muted: #94a3b8;            /* slate-400 */
        --shadow: 0 10px 25px rgba(0,0,0,.35);
      }
    }
    html,body{height:100%;}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: var(--bg); color: var(--text);
      display:grid; place-items:center;
    }
    .card{
      box-shadow: var(--shadow);
      border-radius: 18px; padding: 18px 20px; width:min(680px, 94vw);
      background: var(--card); backdrop-filter: blur(6px);
    }
    .header{display:flex; align-items:center; gap:10px; margin-bottom:14px}
    .dot{width:10px; height:10px; border-radius:999px; background:var(--accent)}
    .title{font-weight:700; letter-spacing:.2px}
    .subtitle{font-size:12px; color:var(--muted)}

    /* BARRE */
    .bar-wrap{position:relative; width:100%; height:18px; background:linear-gradient(90deg, rgba(239,68,68,.18), rgba(245,158,11,.18) 50%, rgba(16,185,129,.18)); border-radius:999px; overflow:hidden}
    .bar{position:absolute; inset:0; width:0%; background:linear-gradient(90deg, var(--bad), var(--warn) 50%, var(--ok));}
    .bar::after{content:""; position:absolute; right:-6px; top:50%; transform:translateY(-50%); width:18px; height:18px; border-radius:50%; background:#fff; box-shadow:0 0 0 3px rgba(0,0,0,.05)}
    .bar-labels{display:flex; justify-content:space-between; font-size:12px; color:var(--muted); margin-top:8px}

    /* JAUGE CIRCULAIRE */
    .gauge{width:180px; height:180px; position:relative}
    .gauge svg{transform:rotate(-90deg)}
    .gauge .value{position:absolute; inset:0; display:grid; place-items:center; font-weight:800; font-size:34px}
    .gauge .caption{position:absolute; left:50%; transform:translateX(-50%); bottom:-6px; font-size:12px; color:var(--muted)}

    .row{display:flex; gap:22px; align-items:center; justify-content:space-between; flex-wrap:wrap}
    .kpis{display:flex; gap:18px; flex-wrap:wrap}
    .kpi{min-width:120px; padding:10px 12px; border-radius:12px; background:rgba(99,102,241,.08)}
    .kpi .k{font-size:11px; color:var(--muted); margin-bottom:4px}
    .kpi .v{font-weight:700}

    .footer{display:flex; justify-content:space-between; align-items:center; margin-top:14px}
    .badge{font-size:11px; padding:6px 10px; border-radius:999px; background:rgba(99,102,241,.12)}
  </style>
</head>
<body>
  <div class="card" id="card">
    <div class="header">
      <div class="dot"></div>
      <div>
        <div class="title" id="title">Score de longévité</div>
        <div class="subtitle" id="subtitle">Personnalisé</div>
      </div>
    </div>

    <div class="row">
      <!-- jauge circulaire -->
      <div class="gauge" id="gauge" aria-hidden="true" style="display:block">
        <svg width="180" height="180" viewBox="0 0 120 120">
          <defs>
            <linearGradient id="grad">
              <stop offset="0%" stop-color="var(--bad)" />
              <stop offset="50%" stop-color="var(--warn)" />
              <stop offset="100%" stop-color="var(--ok)" />
            </linearGradient>
          </defs>
          <circle cx="60" cy="60" r="52" stroke="rgba(148,163,184,.35)" stroke-width="12" fill="none" />
          <circle id="arc" cx="60" cy="60" r="52" stroke="url(#grad)" stroke-width="12" stroke-linecap="round" stroke-dasharray="326.72 326.72" stroke-dashoffset="326.72" fill="none" />
        </svg>
        <div class="value"><span id="val">85</span><span id="unit">/100</span></div>
        <div class="caption" id="caption">Objectif : <span id="goal">90</span></div>
      </div>

      <!-- barre horizontale -->
      <div style="flex:1; min-width:260px">
        <div class="bar-wrap">
          <div class="bar" id="bar"></div>
        </div>
        <div class="bar-labels"><span>Faible</span><span>Moyen</span><span>Élevé</span></div>
        <div class="kpis" style="margin-top:12px">
          <div class="kpi"><div class="k">Score</div><div class="v" id="k-score">85/100</div></div>
          <div class="kpi"><div class="k">Objectif</div><div class="v" id="k-goal">90/100</div></div>
          <div class="kpi"><div class="k">Statut</div><div class="v" id="k-status">▶️ Reste 5 pts</div></div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div class="badge" id="badge">Mise à jour — <span id="date"></span></div>
      <div class="subtitle" id="note">Fajini • Copilote santé</div>
    </div>
  </div>

  <script>
    const score = 85;
    const goal = 90;
    const unit = "/100";
    const circ = 2 * Math.PI * 52;
    const color = score < 50 ? getComputedStyle(document.documentElement).getPropertyValue('--bad')
                : score < 75 ? getComputedStyle(document.documentElement).getPropertyValue('--warn')
                : getComputedStyle(document.documentElement).getPropertyValue('--ok');

    // Barre
    const bar = document.getElementById('bar');
    bar.style.width = score + '%';
    bar.style.background = `linear-gradient(90deg, var(--bad), var(--warn) 50%, var(--ok))`;

    // Jauge
    const arc = document.getElementById('arc');
    arc.setAttribute('stroke-dasharray', `${circ} ${circ}`);
    arc.style.stroke = color;
    requestAnimationFrame(() => {
      const offset = circ * (1 - score / 100);
      arc.style.transition = 'stroke-dashoffset 900ms cubic-bezier(.2,.8,.2,1)';
      arc.setAttribute('stroke-dashoffset', offset);
    });

    // Dot color
    document.querySelector('.dot').style.background = color;

    // Footer date
    document.getElementById('date').textContent = new Date().toLocaleDateString(undefined, {year:'numeric', month:'short', day:'2-digit'});
  </script>
</body>
</html>
